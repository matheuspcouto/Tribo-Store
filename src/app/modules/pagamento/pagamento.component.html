<div *ngIf="loading">
  <app-loadder></app-loadder>
</div>

<section class="h-100 mt-3 section mb-3" *ngIf="!loading">
  <div class="container h-100">
    <div class="row justify-content-md-center h-100">
      <div class="card-wrapper">
        <div class="card fat">
          <div class="card-body" style="background-color: white">

            <a routerLink="/meu-carrinho">
              <button type="button" class="btn btnVoltar text-center">
                <i class="fa fa-arrow-left float-left"></i> Voltar
              </button>
            </a><br>

            <div class="divImg mt-3">
              <img src="assets/logo.jpg" class="img" />
            </div>
            <h2 class="card-title text-center mt-3" id="titulo">
              Pagamento
            </h2>
            <hr />

            <form id="form-checkout" class="my-login-validation" *ngIf="form == 'cartao'">
              <div class="form-group">
                <label>Número do Cartão</label>
                <input id="cardNumber" type="text" name="cardNumber" [(ngModel)]="numeroCartao"
                  class="form-control" required mask="0000 0000 0000" />
                <div *ngIf="errorsValidators">
                  <div *ngFor="let erro of errorsValidators">
                    <p class="label-error" *ngIf="erro.controleErro === 'numero_cartao'">{{erro.mensagemErro}}</p>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="form-group">
                  <label>Vencimento</label>
                  <input id="expirationDate" type="text"
                    class="form-control" required mask="MM/yy" />
                  <div *ngIf="errorsValidators">
                    <div *ngFor="let erro of errorsValidators">
                      <p class="label-error" *ngIf="erro.controleErro === 'vencimento'">{{erro.mensagemErro}}</p>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label>CVV</label>
                  <input id="securityCode" type="number"
                    class="form-control" required />
                  <div *ngIf="errorsValidators">
                    <div *ngFor="let erro of errorsValidators">
                      <p class="label-error" *ngIf="erro.controleErro === 'cvv'">{{erro.mensagemErro}}</p>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label>Titular do Cartão</label>
                <input id="cardholderName" type="text"
                  class="form-control" required />
                <div *ngIf="errorsValidators">
                  <div *ngFor="let erro of errorsValidators">
                    <p class="label-error" *ngIf="erro.controleErro === 'vencimento'">{{erro.mensagemErro}}</p>
                  </div>
                </div>
              </div>

              <div class="row" *ngIf="bandeiras">
                <label>Bandeira</label>
                <div class="form-group col-sm-12">
                  <div class="form-group">
                    <select class="form-select form-select-lg" required name="bandeira" [(ngModel)]="bandeiraSelecionada">
                      <option *ngFor="let bandeira of bandeiras; let i = index" [ngValue]="bandeira.id">
                        {{ bandeira.name }}
                      </option>
                    </select>
                    <div *ngIf="errorsValidators">
                      <div *ngFor="let erro of errorsValidators">
                        <p class="label-error" *ngIf="erro.controleErro === 'formasPagamento'">{{erro.mensagemErro}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row" *ngIf="parcelas">
                <label>Parcelas</label>
                <div class="form-group col-sm-12">
                  <div class="form-group">
                    <select class="form-select form-select-lg" required id="installments">
                      <option *ngFor="let parcela of parcelas.data; let i = index" [ngValue]="parcela">
                        {{ parcela }}
                      </option>
                    </select>
                    <div *ngIf="errorsValidators">
                      <div *ngFor="let erro of errorsValidators">
                        <p class="label-error" *ngIf="erro.controleErro === 'parcelas'">{{erro.mensagemErro}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row" *ngIf="documentos">
                <label>Tipo de Documento</label>
                <div class="form-group col-sm-12">
                  <div class="form-group">
                    <select class="form-select form-select-lg" name="identificationType" [(ngModel)]="docSelecionado" required id="identificationType">
                      <option *ngFor="let doc of documentos; let i = index" [ngValue]="doc.name">
                        {{ doc.name }}
                      </option>
                    </select>
                    <div *ngIf="errorsValidators">
                      <div *ngFor="let erro of errorsValidators">
                        <p class="label-error" *ngIf="erro.controleErro === 'tipo_documento'">{{erro.mensagemErro}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-group" *ngIf="documentos">
                <label>Número do Documento</label>
                <input id="identificationNumber" type="text" name="identificationNumber" [(ngModel)]="numeroDocumento"
                  class="form-control" required [mask]="docSelecionado === 'CPF' ? '000.000.000-00' : '00.000.000/0000-00'" />
                <div *ngIf="errorsValidators">
                  <div *ngFor="let erro of errorsValidators">
                    <p class="label-error" *ngIf="erro.controleErro === 'numero_documento'">{{erro.mensagemErro}}</p>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label>E-mail</label>
                <input id="cardholderEmail" type="email" name="cardholderEmail" [(ngModel)]="email"
                  class="form-control" required />
                <div *ngIf="errorsValidators">
                  <div *ngFor="let erro of errorsValidators">
                    <p class="label-error" *ngIf="erro.controleErro === 'numero_cartao'">{{erro.mensagemErro}}</p>
                  </div>
                </div>
              </div>
            </form>

              <div class="form-group m-0">
                <button (click)="pagar()" type="button"
                  class="btn btn-success btn-block">
                  Realizar Pagamento
                </button>
              </div>

            <hr />
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
